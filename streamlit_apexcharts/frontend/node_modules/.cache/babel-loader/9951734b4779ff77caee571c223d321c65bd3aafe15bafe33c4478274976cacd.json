{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import Chart from\"react-apexcharts\";import{Streamlit}from\"streamlit-component-lib\";// var t =  {\n//       dataPointMouseEnter : {type : 'mouseenter'  , return : [ 'seriesIndex'  ,  'dataPointIndex' ]  } ,  \n//       dataPointSelection : {type :  'mousedown' , return : ['seriesIndex' , 'dataPointIndex' ,  'selectedDataPoints']  }\n//  }\nimport{jsx as _jsx}from\"react/jsx-runtime\";function EventCallback(event,chartContext,config,eventType){// console.log(event)\n// // console.log(chartContext)\n// console.log(config)\n// var eventType = event.type \nStreamlit.setComponentValue({[eventType]:{dataPointIndex:config.dataPointIndex,seriesIndex:config.seriesIndex,selectedDataPoints:\"selectedDataPoints\"in config?config[\"selectedDataPoints\"]:null}});// if (eventType == \"mousedown\") {\n//   var dataPoint =config.selectedDataPoints\n//   var dataPointMap = dataPoint.map( (k :any   , i :any )=>    { \n//     if ( k !== null ) {\n//         // var dataPoindexList = dataPoint[i]\n//         // dataPoindexList\n//         return {\n//             columns  : [index[\"columns\"][i]],  \n//             index :  [index[\"index\"][dataPoint[i]]]\n//         }\n//     }\n//   }  );\n//   dataPointMap = dataPointMap.filter((k:any) => k!= null )\n//   Streamlit.setComponentValue(dataPointMap)   \n// } else {\n//   var dataSeries =config.seriesIndex \n//   var dataPoint = config.dataPointIndex\n//   Streamlit.setComponentValue([ {columns : [index[\"columns\"][dataSeries] ] ,index : [index[\"index\"][dataPoint] ]}])  \n// }\n}const changeFormatterTofuntion=options=>{var Formatter={...options};// var ChangeFormater = {}\nObject.keys(Formatter).map((k,i)=>{if(k in{xaxis:[],yaxis:[]}){if(Array.isArray(Formatter[k])){console.log(Formatter[k]);Formatter[k].map((l,i)=>{if(\"labels\"in Formatter[k][i]){if(\"formatter\"in Formatter[k][i][\"labels\"]){Formatter[k][i][\"labels\"][\"formatter\"]=eval(Formatter[k][i][\"labels\"][\"formatter\"]);}};});}else{if(\"labels\"in Formatter[k]){if(\"formatter\"in Formatter[k][\"labels\"]){Formatter[k][\"labels\"][\"formatter\"]=eval(Formatter[k][\"labels\"][\"formatter\"]);}};};};});return Formatter;};const changeEvents=options=>{var newEvents={...options.chart.events};Object.keys(newEvents).forEach(k=>{newEvents[k]=newEvents[k]?(event,chartContext,config)=>{EventCallback(event,chartContext,config,k);}:null;});var newOptions={...options,chart:{...options.chart,events:newEvents}};return newOptions;};const changeOption=options=>{return changeFormatterTofuntion(changeEvents(options));};function StreamlitCharts(props){const[options,setOptions]=useState(changeOption(props.chart_dict.options));useEffect(()=>{console.log(\"effect\");var newOptions=changeOption(props.chart_dict.options);setOptions(newOptions);},[JSON.stringify(props.chart_dict.options)]);return/*#__PURE__*/_jsx(\"div\",{className:\"app\",children:/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsx(\"div\",{className:\"mixed-chart\",children:/*#__PURE__*/_jsx(Chart,{options:options,series:props.chart_dict.series,type:options.chart.type,width:props.width,height:options.chart.height})})})});}export default StreamlitCharts;","map":{"version":3,"names":["React","useState","useEffect","Chart","Streamlit","jsx","_jsx","EventCallback","event","chartContext","config","eventType","setComponentValue","dataPointIndex","seriesIndex","selectedDataPoints","changeFormatterTofuntion","options","Formatter","Object","keys","map","k","i","xaxis","yaxis","Array","isArray","console","log","l","eval","changeEvents","newEvents","chart","events","forEach","newOptions","changeOption","StreamlitCharts","props","setOptions","chart_dict","JSON","stringify","className","children","series","type","width","height"],"sources":["/home/kobe/Project/streamlit-apexcharts/streamlit_apexcharts/frontend/src/ChartStreamlit.tsx"],"sourcesContent":["\nimport React, { Component ,useState , useEffect , useRef, useCallback } from \"react\";\nimport Chart from \"react-apexcharts\";\nimport {\n    Streamlit,\n  } from \"streamlit-component-lib\"\n\n// var t =  {\n\n//       dataPointMouseEnter : {type : 'mouseenter'  , return : [ 'seriesIndex'  ,  'dataPointIndex' ]  } ,  \n\n\n//       dataPointSelection : {type :  'mousedown' , return : ['seriesIndex' , 'dataPointIndex' ,  'selectedDataPoints']  }\n\n\n//  }\n\n\n\n  function EventCallback (event :any , chartContext :any , config :any , eventType :any  ) {\n\n    // console.log(event)\n\n    // // console.log(chartContext)\n    // console.log(config)\n\n      // var eventType = event.type \n\n      Streamlit.setComponentValue( { [eventType] :  {dataPointIndex : config.dataPointIndex  , seriesIndex : config.seriesIndex  ,selectedDataPoints :  \"selectedDataPoints\" in  config ?config[\"selectedDataPoints\"] : null  } })   \n\n      // if (eventType == \"mousedown\") {\n\n      //   var dataPoint =config.selectedDataPoints\n    \n      //   var dataPointMap = dataPoint.map( (k :any   , i :any )=>    { \n          \n      //     if ( k !== null ) {\n\n      //         // var dataPoindexList = dataPoint[i]\n\n      //         // dataPoindexList\n  \n      //         return {\n      //             columns  : [index[\"columns\"][i]],  \n      //             index :  [index[\"index\"][dataPoint[i]]]\n      //         }\n  \n      //     }\n  \n      //   }  );\n  \n      //   dataPointMap = dataPointMap.filter((k:any) => k!= null )\n  \n      //   Streamlit.setComponentValue(dataPointMap)   \n\n      // } else {\n\n\n      //   var dataSeries =config.seriesIndex \n\n      //   var dataPoint = config.dataPointIndex\n\n      //   Streamlit.setComponentValue([ {columns : [index[\"columns\"][dataSeries] ] ,index : [index[\"index\"][dataPoint] ]}])  \n\n      // }\n\n \n\n  }\n\n\n\nconst changeFormatterTofuntion = (options :any ) => {\n\n  var Formatter = {...options}\n  // var ChangeFormater = {}\n\n   Object.keys(Formatter).map( (k , i ) => {\n\n      if (k in {xaxis:[] , yaxis : [] }){\n\n          if (Array.isArray(Formatter[k]) ){\n\n\n              console.log(Formatter[k])\n\n             Formatter[k].map(( l : any , i :any ) => {\n\n                if ( \"labels\" in Formatter[k][i] ) {\n\n                  if ( \"formatter\" in Formatter[k][i][\"labels\"] ) {\n  \n                   Formatter[k][i][\"labels\"][\"formatter\"] = eval(Formatter[k][i][\"labels\"][\"formatter\"])\n                  }\n                };\n\n             })\n\n          }else{\n\n            \n            if ( \"labels\" in Formatter[k] ) {\n\n              if ( \"formatter\" in Formatter[k][\"labels\"] ) {\n\n                Formatter[k][\"labels\"][\"formatter\"] = eval(Formatter[k][\"labels\"][\"formatter\"])\n              }\n            };\n\n\n\n\n          };\n\n\n\n\n\n        };\n    } )\n\n    return Formatter\n\n} \n\n\nconst changeEvents = (options : any ) => {\n\n\n      var newEvents = {...options.chart.events}\n\n      Object.keys(newEvents).forEach((k) => {\n        newEvents[k]  = newEvents[k] ?  (event :any , chartContext :any , config :any ) =>  {     EventCallback(event , chartContext , config   , k ) }   : null\n       })\n\n       var newOptions = {...options , chart  : { ...options.chart , events : newEvents} }\n\n       return newOptions\n}\n\n\nconst changeOption = (options : any ) => {\n\n    return changeFormatterTofuntion(changeEvents(options))\n\n}\n\n\n\n\n\n\n\nfunction StreamlitCharts(props:any) {\n\n    const [options, setOptions] = useState( changeOption(props.chart_dict.options )  )\n\n    \n\n    useEffect(  () => {\n\n      console.log(\"effect\")\n      var newOptions = changeOption(props.chart_dict.options)\n\n      setOptions(newOptions)\n\n    } , [JSON.stringify(props.chart_dict.options) ]\n    )\n\n\n    return (\n        <div className=\"app\" >\n        <div className=\"row\">\n          <div className=\"mixed-chart\">\n\n            <Chart\n              options={ options}\n              series={props.chart_dict.series} \n              type= { options.chart.type}\n              width= {props.width}\n              height= { options.chart.height}\n            />\n          </div>\n        </div>\n      </div>\n    );\n  }\n  \nexport default StreamlitCharts;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}