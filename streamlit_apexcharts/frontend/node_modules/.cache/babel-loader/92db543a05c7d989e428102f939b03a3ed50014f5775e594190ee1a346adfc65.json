{"ast":null,"code":"import React,{useState,useEffect,useRef}from\"react\";import Chart from\"react-apexcharts\";import{Streamlit}from\"streamlit-component-lib\";// var t =  {\n//       dataPointMouseEnter : {type : 'mouseenter'  , return : [ 'seriesIndex'  ,  'dataPointIndex' ]  } ,  \n//       dataPointSelection : {type :  'mousedown' , return : ['seriesIndex' , 'dataPointIndex' ,  'selectedDataPoints']  }\n//  }\nimport{jsx as _jsx}from\"react/jsx-runtime\";function EventCallback(event,chartContext,config,eventType){// console.log(event)\n// // console.log(chartContext)\n// console.log(config)\n// var eventType = event.type \nStreamlit.setComponentValue({[eventType]:{dataPointIndex:config.dataPointIndex,seriesIndex:config.seriesIndex,selectedDataPoints:\"selectedDataPoints\"in config?config[\"selectedDataPoints\"]:null}});// if (eventType == \"mousedown\") {\n//   var dataPoint =config.selectedDataPoints\n//   var dataPointMap = dataPoint.map( (k :any   , i :any )=>    { \n//     if ( k !== null ) {\n//         // var dataPoindexList = dataPoint[i]\n//         // dataPoindexList\n//         return {\n//             columns  : [index[\"columns\"][i]],  \n//             index :  [index[\"index\"][dataPoint[i]]]\n//         }\n//     }\n//   }  );\n//   dataPointMap = dataPointMap.filter((k:any) => k!= null )\n//   Streamlit.setComponentValue(dataPointMap)   \n// } else {\n//   var dataSeries =config.seriesIndex \n//   var dataPoint = config.dataPointIndex\n//   Streamlit.setComponentValue([ {columns : [index[\"columns\"][dataSeries] ] ,index : [index[\"index\"][dataPoint] ]}])  \n// }\n}const changeFormatterTofuntion=options=>{var Formatter={...options};// var ChangeFormater = {}\nObject.keys(Formatter).map((k,i)=>{if(k in{xaxis:[],yaxis:[]}){if(Array.isArray(Formatter[k])){Formatter[k].map((l,i)=>{if(\"labels\"in Formatter[k][i]&&\"formatter\"in Formatter[k][i][\"labels\"]){Formatter[k][i][\"labels\"][\"formatter\"]=eval(Formatter[k][i][\"labels\"][\"formatter\"]);}});}else{if(\"labels\"in Formatter[k]&&\"formatter\"in Formatter[k][\"labels\"]){Formatter[k][\"labels\"][\"formatter\"]=eval(Formatter[k][\"labels\"][\"formatter\"]);};};};if(k in{tooltip:[]}){Object.keys(Formatter[k]).map(l=>{if(l in{x:[],y:[],z:[]}){if(\"formatter\"in Formatter[k][l]){Formatter[k][l][\"formatter\"]=eval(Formatter[k][l][\"formatter\"]);}if(l==\"y\"&&\"title\"in Formatter[k][l]&&\"formatter\"in Formatter[k][l][\"title\"]){Formatter[k][l][\"title\"][\"formatter\"]=eval(Formatter[k][l][\"title\"][\"formatter\"]);}}});}if(k in{dataLabels:[]}){if(\"formatter\"in Formatter[k]){Formatter[k][\"formatter\"]=eval(Formatter[k][\"formatter\"]);}}});return Formatter;};const changeEvents=options=>{var newEvents={...options.chart.events};Object.keys(newEvents).forEach(k=>{newEvents[k]=newEvents[k]?(event,chartContext,config)=>{EventCallback(event,chartContext,config,k);}:null;});var newOptions={...options,chart:{...options.chart,events:newEvents}};return newOptions;};const changeOption=options=>{return changeFormatterTofuntion(changeEvents(options));};function StreamlitCharts(props){const[options,setOptions]=useState(changeOption(props.chart_dict.options));const chart=useRef(null);useEffect(()=>{var newOptions=changeOption(props.chart_dict.options);// chart.hideSeries('Cricket')\n// chart.current.hideSeries('Cricket')\n// console.log(chart.current.chart)\nsetOptions(newOptions);},[JSON.stringify(props.chart_dict.options)]);return/*#__PURE__*/_jsx(\"div\",{className:\"test\",children:/*#__PURE__*/_jsx(Chart,{options:options,series:props.chart_dict.series,type:options.chart.type,width:props.width,height:options.chart.height,ref:chart})});}export default StreamlitCharts;","map":{"version":3,"names":["React","useState","useEffect","useRef","Chart","Streamlit","jsx","_jsx","EventCallback","event","chartContext","config","eventType","setComponentValue","dataPointIndex","seriesIndex","selectedDataPoints","changeFormatterTofuntion","options","Formatter","Object","keys","map","k","i","xaxis","yaxis","Array","isArray","l","eval","tooltip","x","y","z","dataLabels","changeEvents","newEvents","chart","events","forEach","newOptions","changeOption","StreamlitCharts","props","setOptions","chart_dict","JSON","stringify","className","children","series","type","width","height","ref"],"sources":["/home/kobe/Project/streamlit-apexcharts/streamlit_apexcharts/frontend/src/ChartStreamlit.tsx"],"sourcesContent":["\nimport React, { Component ,useState , useEffect , useRef, useCallback } from \"react\";\nimport Chart from \"react-apexcharts\";\nimport {\n    Streamlit,\n  } from \"streamlit-component-lib\"\n\n// var t =  {\n\n//       dataPointMouseEnter : {type : 'mouseenter'  , return : [ 'seriesIndex'  ,  'dataPointIndex' ]  } ,  \n\n\n//       dataPointSelection : {type :  'mousedown' , return : ['seriesIndex' , 'dataPointIndex' ,  'selectedDataPoints']  }\n\n\n//  }\n\n\n\n  function EventCallback (event :any , chartContext :any , config :any , eventType :any  ) {\n\n    // console.log(event)\n\n    // // console.log(chartContext)\n    // console.log(config)\n\n      // var eventType = event.type \n\n      Streamlit.setComponentValue( { [eventType] :  {dataPointIndex : config.dataPointIndex  , seriesIndex : config.seriesIndex  ,selectedDataPoints :  \"selectedDataPoints\" in  config ?config[\"selectedDataPoints\"] : null  } })   \n\n      // if (eventType == \"mousedown\") {\n\n      //   var dataPoint =config.selectedDataPoints\n    \n      //   var dataPointMap = dataPoint.map( (k :any   , i :any )=>    { \n          \n      //     if ( k !== null ) {\n\n      //         // var dataPoindexList = dataPoint[i]\n\n      //         // dataPoindexList\n  \n      //         return {\n      //             columns  : [index[\"columns\"][i]],  \n      //             index :  [index[\"index\"][dataPoint[i]]]\n      //         }\n  \n      //     }\n  \n      //   }  );\n  \n      //   dataPointMap = dataPointMap.filter((k:any) => k!= null )\n  \n      //   Streamlit.setComponentValue(dataPointMap)   \n\n      // } else {\n\n\n      //   var dataSeries =config.seriesIndex \n\n      //   var dataPoint = config.dataPointIndex\n\n      //   Streamlit.setComponentValue([ {columns : [index[\"columns\"][dataSeries] ] ,index : [index[\"index\"][dataPoint] ]}])  \n\n      // }\n\n \n\n  }\n\n\n\nconst changeFormatterTofuntion = (options :any ) => {\n\n  var Formatter = {...options}\n  // var ChangeFormater = {}\n\n   Object.keys(Formatter).map( (k , i ) => {\n\n      if (k in {xaxis:[] , yaxis : [] }){\n\n          if (Array.isArray(Formatter[k]) ){\n             Formatter[k].map(( l : any , i :any ) => {\n\n              if (  (\"labels\" in Formatter[k][i])   &&  ( \"formatter\" in Formatter[k][i][\"labels\"])  ) {\n\n                  Formatter[k][i][\"labels\"][\"formatter\"] = eval(Formatter[k][i][\"labels\"][\"formatter\"])\n\n              }\n\n             })\n\n          }else{\n\n            if ( \"labels\" in Formatter[k] && \"formatter\" in Formatter[k][\"labels\"] ) {\n\n                Formatter[k][\"labels\"][\"formatter\"] = eval(Formatter[k][\"labels\"][\"formatter\"])\n            \n            };\n          };\n\n\n\n\n\n        };\n\n      if (k in {tooltip : []} ) {\n\n        Object.keys(Formatter[k]).map( (l :any ) => {\n\n          if (l  in {x : [] , y : [] , z  : [] }){\n\n            if (  \"formatter\" in  Formatter[k][l]) {\n              Formatter[k][l][\"formatter\"] = eval(Formatter[k][l][\"formatter\"] )\n\n              }\n            \n\n            if ( (l == \"y\")  &&  (\"title\" in  Formatter[k][l]) && ( \"formatter\" in   Formatter[k][l][\"title\"] ) ) {\n\n              Formatter[k][l][\"title\"][\"formatter\" ] =   eval(Formatter[k][l][\"title\"][\"formatter\" ])\n\n\n            }\n\n\n\n          }\n        })\n      }\n\n\n\n      if (k in {dataLabels : []} ) {\n        \n        if ( \"formatter\" in Formatter[k] ){\n          Formatter[k][\"formatter\"] = eval(Formatter[k][\"formatter\"]  )\n        }\n      }\n\n\n      } )\n\n    return Formatter\n\n} \n\n\nconst changeEvents = (options : any ) => {\n\n\n      var newEvents = {...options.chart.events}\n\n      Object.keys(newEvents).forEach((k) => {\n        newEvents[k]  = newEvents[k] ?  (event :any , chartContext :any , config :any ) =>  {     EventCallback(event , chartContext , config   , k ) }   : null\n       })\n\n       var newOptions = {...options , chart  : { ...options.chart , events : newEvents} }\n\n       return newOptions\n}\n\n\nconst changeOption = (options : any ) => {\n\n    return changeFormatterTofuntion(changeEvents(options))\n\n}\n\n\n\n\n\n\n\nfunction StreamlitCharts(props:any) {\n\n    const [options, setOptions] = useState( changeOption(props.chart_dict.options )  )\n\n    const chart = useRef<Chart>(null)\n\n    \n\n    useEffect(  () => {\n\n\n      var newOptions = changeOption(props.chart_dict.options)\n\n\n      // chart.hideSeries('Cricket')\n\n      // chart.current.hideSeries('Cricket')\n\n      // console.log(chart.current.chart)\n\n      setOptions(newOptions)\n\n    } , [JSON.stringify(props.chart_dict.options) ]\n    )\n    return (\n        <div className=\"test\">\n         {/* <div className=\"row\">\n           <div className=\"mixed-chart\"> */}\n             <Chart\n              options={ options}\n              series={props.chart_dict.series} \n              type= { options.chart.type}\n              width= {props.width}\n              height= { options.chart.height}\n              ref={ chart  }\n             />\n          {/* </div>\n        </div> */}\n      </div>\n    );\n  }\n  \nexport default StreamlitCharts;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}